# 卷积核与全连接层关系说明

## 1. 卷积核的数量与作用

- **卷积核（Convolution Kernel）**是CNN中用于提取特征的参数矩阵。
- 在本demo中，第二层卷积有32个卷积核（`conv2`），**所有类别共享这32个卷积核**。
- 这32个卷积核负责对所有输入图片提取特征，不管图片属于哪个类别。
- 卷积核的参数（权重）在训练过程中通过反向传播自动学习得到。

## 2. 全连接层的权重结构

- **全连接层（Fully Connected Layer）**的权重矩阵形状为 `[10, 1568]`，即10行1568列。
    - 10行：对应10个数字类别（0~9），每一行是一个类别的权重向量。
    - 1568列：对应32个卷积核 × 7 × 7（每个卷积核展平后有49个特征点）。
- **每个类别有一套自己的全连接层权重**，但卷积核本身的参数是共享的。

## 3. 权重分配与类别的关系

- **每个类别的全连接层权重都不一样**，这是模型区分不同数字的关键。
- **每个类别对每个卷积核的“关注”程度（权重）也都不一样**，是模型自动学习出来的。
- 例如：卷积核5学会了检测“圆圈”特征，那么数字0、6、8、9的全连接层权重中，卷积核5相关的权重可能更大。
- 但卷积核5本身的参数（权重）是所有类别共享的。

## 4. 不是“32×10个卷积核”

- **卷积核只有32个**，所有类别共用。
- **全连接层有10行权重**，每行都“关注”这32个卷积核展平后的特征，但每行的权重分配不同。
- 你可以理解为：**卷积核负责提特征，全连接层负责“组合”这些特征来判断类别**。

## 5. 训练与推理阶段的权重变化

- **训练阶段**：模型的参数（包括卷积核和全连接层的权重）会不断调整，以最小化损失函数。
- **训练结束后**，所有参数都“定型”了，变成了**固定的数值**。
- **推理（预测）阶段**：每次输入不同的图片，卷积核和全连接层的权重都不会变，变的是输入特征。

## 6. 总结

- **卷积核参数只有32套，所有类别共享。**
- **全连接层有10行权重，每行都对应32×7×7个特征点，每个类别一套。**
- **不是32×10个卷积核，而是32个卷积核+10套全连接层权重。**
- **每个类别的全连接层权重都不一样，每个类别对卷积核特征的“关注”也不一样。**

---

如需可视化卷积核本身的权重，或者想看全连接层如何“组合”卷积核特征，也可以继续提问！ 